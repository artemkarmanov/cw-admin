<cwb-page-top>
    <cwb-button-header>
        <h1>Sessions</h1>
        <button (click)="reload()" class="btn btn-sm text-primary">
            <cwb-icon name="arrow-clockwise"></cwb-icon>
        </button>
    </cwb-button-header>
</cwb-page-top>

<cwb-card>
    <div class="row">
        <cwb-filter class="col"></cwb-filter>
        <div class="col action-buttons">
            <button class="btn btn-secondary"
                [disabled]="isRowSelected"
                (click)="renderSessionCaptionsViewDialog(selectedSession)">
                Caption Log
            </button>
        </div>
    </div>
    <table>
        <thead>
        <tr class="table-light">
            <th>Session ID</th>
            <th>Title</th>
            <th>Session start</th>
            <th>Duration</th>
            <th>Status</th>
            <th>Owner</th>
            <th>&nbsp;</th>
        </tr>
        </thead>
        <ng-container *ngIf="sessions$ | async as sessions">
            <tbody *ngIf="sessions.length;else empty">
                <tr *ngFor="let session of sessions; let i = index"
                    (click)="selectRow(i, session.sessionId)"
                    [class.selected]="selectedRow === i">
                    <ng-container *ngIf="isNotCancelled(session)">
                        <td>{{session.sessionId}}</td>
                        <td><a [routerLink]="'/bookings/'+session.bookingToken">{{session.title}}</a></td>
                        <td>{{session.startEpoch | adjustTime: session.bookingTimeZone | async | date: 'd MMM YYYY h:mm a'}}</td>
                        <td>{{session.sessionDurationMins}}</td>
                        <td><span cwbStatus>{{session.status}}</span></td>
                        <td>{{session | owner}}</td>
                        <td>
                            <button (click)="showLogs(session)" class="btn">
                                Logs
                            </button>
                            <ng-container *ngIf="isEditable(session)">
                                <button (click)="edit(session)" class="btn">
                                    <cwb-icon name="pencil"></cwb-icon>
                                </button>
                                <button (click)="cancel(session.sessionId)" class="btn">
                                    <cwb-icon name="x-lg"></cwb-icon>
                                </button>
                            </ng-container>
                        </td>
                    </ng-container>
                </tr>
            </tbody>
        </ng-container>
    </table>
    <ng-template #empty>
        <tr>
            <td class="text-center" colspan="6" style="padding:48px;">
                <div>
                    There are not any sessions
                </div>

            </td>
        </tr>
    </ng-template>
</cwb-card>
